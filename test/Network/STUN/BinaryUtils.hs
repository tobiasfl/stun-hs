module Network.STUN.BinaryUtils
    (magicCookie
    , bindRequest
    , bindSuccess
    , bindError
    , stunBindRequest
    , stunBindSuccessResponse
    , stunBindErrorResponse
    , errorCode500Attribute
    , errorCode420Attribute
    , mappedAddressAttribute
    , xorMappedAddressAttribute
    , classicStunBindRequest)
    where

import qualified Data.ByteString as BS
import Data.Word (Word8)

magicCookie :: BS.StrictByteString
magicCookie = BS.pack [0x21, 0x12, 0xa4, 0x42]

bindRequest :: BS.StrictByteString
bindRequest = BS.pack [0x00, 0x01]

bindSuccess :: BS.StrictByteString
bindSuccess = BS.pack [0x01, 0x01]

bindError :: BS.StrictByteString
bindError = BS.pack [0x01, 0x11]

stunBindRequest :: Word8 -> BS.StrictByteString
stunBindRequest len = bindRequest <> BS.pack [0x00, len] <> magicCookie <>
    BS.pack [0x53, 0x4f, 0x70, 0x43, 0x69, 0x69, 0x35, 0x4a, 0x66, 0x63, 0x31, 0x7a]

stunBindSuccessResponse :: Word8 -> BS.StrictByteString
stunBindSuccessResponse len = bindSuccess <> BS.pack [0x00, len] <> magicCookie <>
    BS.pack [0x53, 0x4f, 0x70, 0x43, 0x69, 0x69, 0x35, 0x4a, 0x66, 0x63, 0x31, 0x7a]

stunBindErrorResponse :: Word8 -> BS.StrictByteString
stunBindErrorResponse len = bindError <> BS.pack [0x00, len] <> magicCookie <>
    BS.pack [0x53, 0x4f, 0x70, 0x43, 0x69, 0x69, 0x35, 0x4a, 0x66, 0x63, 0x31, 0x7a]

errorCode500Attribute :: BS.StrictByteString
errorCode500Attribute = BS.pack [0x00, 0x09, 0x00, 0x10, 0x00, 0x00, 0x05, 0x00, 0x53, 0x45, 0x52, 0x56, 0x45, 0x52, 0x20, 0x45, 0x52, 0x52, 0x4f, 0x52]

errorCode420Attribute :: BS.StrictByteString
errorCode420Attribute = BS.pack [0x00, 0x09, 0x00, 0x04, 0x00, 0x00, 0x04, 0x14]

mappedAddressAttribute :: BS.StrictByteString
mappedAddressAttribute = BS.pack [0x00, 0x01, 0x00, 0x08, 0x00, 0x01, 0x11, 0xfc, 0x46, 0xc7, 0x80, 0x2e]

xorMappedAddressAttribute :: BS.StrictByteString
xorMappedAddressAttribute = BS.pack [0x00, 0x20, 0x00, 0x14, 0x00, 0x02, 0x11, 0xfc, 0x46, 0xc7, 0x80, 0x2e, 0x46, 0xc7, 0x80, 0x2e, 0x46, 0xc7, 0x80, 0x2e, 0x46, 0x2e, 0xc7, 0x80]

classicStunBindRequest :: BS.StrictByteString
classicStunBindRequest = bindRequest <> BS.pack [0x00, 0x00, 0x02, 0x90, 0x0a, 0x4c, 0x1d, 0x4f, 0xb6, 0x5e, 0x15, 0x8f, 0xd0, 0x3b, 0x8e, 0xc6, 0x89, 0x6a]
